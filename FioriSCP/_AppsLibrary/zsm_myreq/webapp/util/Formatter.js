/*
 * Copyright (C) 2009-2017 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["zsm/itsm/myreq/cust/util/Util","sap/ui/core/format/FileSizeFormat","sap/ui/core/format/DateFormat","zsm/itsm/myreq/cust/util/Formatter"],function(U,F,D,f){"use strict";return{formatter:f,init:function(m){var t=this;this.oModel=m;this.jamModel=new sap.ui.model.odata.ODataModel("/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData",true);this.isJamSupported=true;this.jamModel.attachMetadataFailed(function(){t.isJamSupported=false;});this.picBuffer=[];},dateShort:function(d){var o=(d instanceof Date)?d:new Date(d);var a=sap.ui.core.format.DateFormat.getDateInstance({pattern:"dd.MM.yyyy"});return a.format(o);},dateTime:function(d){var o=(d instanceof Date)?d:new Date(d);var a=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"dd.MM.yyyy HH:mm"});return a.format(o);},getPicture:function(i){if(!this.formatter){this.formatter=this;}var t=this;if(i===""){return"";}var u="";var b=false;if(this.formatter.isJamSupported===false){return"";}$.each(this.formatter.picBuffer,function(a,v){if(v.id===i){u=v.url;b=true;}});if(b===true){return u;}if(u===""){var s="/Members_Autocomplete?Query=%27"+i+"%27&$expand=ThumbnailImage";this.formatter.jamModel.read(s,null,null,false,function(d){if(d.results[0]){var a=d.results[0].ThumbnailImage.__metadata.media_src;u="/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData/"+a;var p={id:i,url:u};t.formatter.picBuffer.push(p);}},function(){});}return u;},formatFileSizeAttribute:function(v){if(jQuery.isNumeric(v)){return F.getInstance({binaryFilesize:false,maxFractionDigits:1,maxIntegerDigits:3}).format(v);}else{return v;}}};});
