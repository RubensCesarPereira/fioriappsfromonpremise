sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/model/json/JSONModel","sap/m/MessageBox","cl/conchaytoro/zpp_descomponer_mezcla/model/formatter"],function(e,t,a,i,o){"use strict";return e.extend("cl.conchaytoro.zpp_descomponer_mezcla.controller.View1",{formatter:o,onInit:function(){},_inputMaterial:function(e,t){var a=this.getView().byId("centro");var i=a.getSelectedKey();var o=this.getView().byId("codMezcla");var s=o.getValue();if(i===""){sap.m.MessageBox.warning("¡Favor seleccione Bodega!",{title:"Advertencia",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit});if(t.Matnr===""){sap.m.MessageBox.warning("¡Material No Existe en Bodega Seleccionada!",{title:"Advertencia",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}s.setValue("")}else{if(/^(M?\d{4}-?\d{4})|\d{6}$/.test(s)){this.handleValidationSuccess2(e)}else{this.handleValidationError2(e)}}},_inputCompo:function(e){var t=this.getView().byId("codCompo");var a=t.getValue();var i=this.getView().byId("centro");var o=i.getSelectedKey();if(o===""){sap.m.MessageBox.warning("¡Favor seleccione Bodega!",{title:"Advertencia",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit});if(oData.Matnr===""){sap.m.MessageBox.warning("¡Material No Existe en Bodega Seleccionada!",{title:"Advertencia",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}a.setValue("")}else{if(/^(M?\d{4}-?\d{4})|\d{6}$/.test(a)){e.getSource().setValueState(sap.ui.core.ValueState.Success)}else{e.getSource().setValueState(sap.ui.core.ValueState.Error);this.clearCells()}}},handleValidationSuccess2:function(e){e.getSource().setValueState(sap.ui.core.ValueState.Success);this._inputDescript(e)},handleValidationError2:function(e){e.getSource().setValueState(sap.ui.core.ValueState.Error);var t=this.getView().byId("descripcion");t.setValue("");var a=this.getView().byId("codCompo");a.setValue("");a.setValueState(sap.ui.core.ValueState.Error);this.clearCells()},_inputDescript:function(e){var t=this.getView().byId("codMezcla");var a=t.getValue();var i=this.getView().byId("centro").getSelectedKey();var o=this.getView().byId("descripcion");var s="Sin Descripción";var r=this.getOwnerComponent().getModel();r.read("/MaterialSet(Matnr='"+a+"',Werks='"+i+"')",{success:function(e){if(e.Matnr===""){sap.m.MessageBox.warning("¡Material No Existe en Bodega Seleccionada!",{title:"Advertencia",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}else{s=e.Maktx;o.setValue(s)}}.bind(this),error:function(e){var t="hola";return t}})},clearCells:function(e){var t=this.getView().byId("tablaMezcla");t.removeAllItems()},_clearMatnr:function(){this.getView().byId("descripcion").setValue("");this.getView().byId("codMezcla").setValue("");this.getView().byId("codCompo").setValue("");this.getView().byId("codMezcla").setValueState(sap.ui.core.ValueState.None);this.getView().byId("codCompo").setValueState(sap.ui.core.ValueState.None);this.clearCells()},buscaMezclas:function(){var e=this.getView().byId("tablaMezcla");var t=this.getOwnerComponent().getModel("dos");var i=this.getView().byId("codMezcla");var o=this.getView().byId("centro");var s=this.getView().byId("codCompo");var r=i.getValue();var l=o.getSelectedKey();var n=s.getValue();if(i.getValue()===""||i.getValueState()!==sap.ui.core.ValueState.Success||o.getSelectedKey()===""||s.getValue()===""||s.getValueState()!==sap.ui.core.ValueState.Success){sap.m.MessageBox.error("¡Favor Completar Campos Vacíos!",{title:"Error",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}else{var c=[];var u=new sap.ui.model.Filter("Codigo",sap.ui.model.FilterOperator.EQ,r);c.push(u);u=new sap.ui.model.Filter("Codigo2",sap.ui.model.FilterOperator.EQ,n);c.push(u);u=new sap.ui.model.Filter("Bodega",sap.ui.model.FilterOperator.EQ,l);c.push(u);sap.ui.core.BusyIndicator.show();t.read("/DescomponerSet",{filters:c,success:function(t){sap.ui.core.BusyIndicator.hide();e.setModel(new a(t.results),"mezclas")},error:function(t){sap.ui.core.BusyIndicator.hide();e.setModel(new a([]),"mezclas");sap.m.MessageBox.error("Error en El Servicio",{title:"Error",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}})}},onPress:function(e){var t=e.getSource().getCells()[6].getTitle();var a=e.getSource().getCells()[0].getText();var i=sap.ui.core.UIComponent.getRouterFor(this);i.navTo("Materiales",{Orden:t,Cantidad:a})}})});