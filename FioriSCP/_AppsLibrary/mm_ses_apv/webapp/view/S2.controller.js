/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.ScfldMasterController");jQuery.sap.require("sap.ca.ui.model.format.AmountFormat");jQuery.sap.require("sap.ca.ui.model.type.Date");jQuery.sap.require("ui.s2p.mm.ses.approve.util.Formatter");sap.ca.scfld.md.controller.ScfldMasterController.extend("ui.s2p.mm.ses.approve.view.S2",{onInit:function(){var t=this;this.oDataModel=this.oApplicationFacade.getODataModel();this.byId("list").getBinding("items").attachDataReceived(this.onListDataReceived,this);var c=new sap.ui.model.Sorter("CreatedAt",false,false);var C=new sap.ui.model.Sorter("CreatedAt",true,false);var o=new sap.ui.model.Sorter("CreatedByName",false,false);var a=new sap.ui.model.Sorter("CreatedByName",true,false);var T=new sap.ui.model.Sorter("ActualValue",false,false);var b=new sap.ui.model.Sorter("ActualValue",true,false);this.registerEvents();this.attachRouteMatchedHandler();this.oHeaderFooterOptions={sI18NMasterTitle:"MASTER_TITLE",oSortOptions:{aSortItems:[{text:this.getView().getModel("i18n").getResourceBundle().getText("SORT_OPTION_CREATED_BY_ASCENDING"),key:"CreatedByAscending"},{text:this.getView().getModel("i18n").getResourceBundle().getText("SORT_OPTION_CREATED_BY_DESCENDING"),key:"CreatedByDescending"},{text:this.getView().getModel("i18n").getResourceBundle().getText("SORT_OPTION_CREATED_ON_ASCENDING"),key:"CreatedAtAscending"},{text:this.getView().getModel("i18n").getResourceBundle().getText("SORT_OPTION_CREATED_ON_DESCENDING"),key:"CreatedAtDescending"},{text:this.getView().getModel("i18n").getResourceBundle().getText("SORT_OPTION_TOTAL_VALUE_ASCENDING"),key:"TotalValueAscending"},{text:this.getView().getModel("i18n").getResourceBundle().getText("SORT_OPTION_TOTAL_VALUE_DESCENDING"),key:"TotalValueDescending"}],sSelectedItemKey:"CreatedAtDescending",onSortSelected:function(k){var B=t.getView().byId('list').getBinding("items");if(k==="CreatedByAscending"){B.sort([o])}else if(k==="CreatedByDescending"){B.sort([a])}else if(k==="CreatedAtDescending"){B.sort([C])}else if(k==="CreatedAtAscending"){B.sort([c])}else if(k==="TotalValueAscending"){B.sort([T])}else if(k==="TotalValueDescending"){B.sort([b])}else{var s=[];s=t.getSorterForSortOption(k);B.sort(s);if(s.length<=0){t.oHeaderFooterOptions.oSortOptions.sSelectedItemKey="";return}}t.oHeaderFooterOptions.oSortOptions.sSelectedItemKey=k}},};if(this.extHookAddOrChangeSortOptions){this.oHeaderFooterOptions.oSortOptions=this.extHookAddOrChangeSortOptions(this.oHeaderFooterOptions.oSortOptions)}},onListDataReceived:function(e){var c=sap.ui.core.Component.getOwnerIdFor(this.getView());var C=sap.ui.component(c);C.oEventBus.publish("ui.s2p.mm.ses.approve","S2DataReceived")},getSorterForSortOption:function(k){var s=[];if(this.extHookGetSorterForSortOption){s=this.extHookGetSorterForSortOption(k)}return s},registerEvents:function(){var c=sap.ui.core.Component.getOwnerIdFor(this.getView());var C=sap.ui.component(c);C.oEventBus.subscribe("ui.s2p.mm.ses.approve","asesApproveRejectForward",this.handleActionCallBack,this)},attachRouteMatchedHandler:function(e){this.oRouter.attachRoutePatternMatched(function(e){if(e.getParameter("name")==="detail"){var b=this.getBindingContextPathFor(e.getParameter("arguments"));var i=this.findItemByContextPath(b);var l=this.getList();var a=l.indexOfItem(i);a=a+1;if(a>=l.getItems().length){a=0}if(l.getItems().length===0){a=-1}if(a>=0){var n=l.getItems()[a];this._sNextDetailPath=n&&n.getBindingContext(this.sModelName).getPath()}else{this._sNextDetailPath=""}}},this)},handleActionCallBack:function(c,e,d){if(e==="asesApproveRejectForward"){var i=this.findItemByContextPath(this._sNextDetailPath);if(i){this.setListItem(i)}else{if(this.getList().getItems().length>1){this.selectFirstItem()}else{this.showEmptyView("DETAIL_TITLE","NO_ITEMS_AVAILABLE")}}}},getHeaderFooterOptions:function(){return this.oHeaderFooterOptions}});
